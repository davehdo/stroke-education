<p id="notice"><%= notice %></p>

<p>
  <strong>Text:</strong>
  <%= @message.text %>
</p>

<p>
  <strong>Recipient:</strong>
  <%= @message.recipient %>
</p>

<p>
  <strong>Report:</strong>
  <%= link_to "Report", @message.report %>
</p>

<p>
  <strong>Message category:</strong>
  <%= @message.message_category %>
</p>

<div class="contain-link">
  <textarea rows="6" id="link-for-<%= @message.report.to_param %>-1" 

    style="width: 200px; 
      padding: 0px; margin: 0px; "><%= (@message.text || "").gsub("[URL]", "http://#{ request.env["HTTP_HOST"] }#{ show_by_key_messages_path(key: @message.key) }") %></textarea>
  <a href="#" onclick="copyLinkFor('<%= @message.report.to_param %>-1')">Copy</a> 
  <span class="checkmark"><i class="fa fa-check" aria-hidden="true"></i></span>
</div>


<script type="text/javascript">
  const copyLinkFor = (id) => {                  
    let copyText = $(`#link-for-${ id }`);
    $("*.copied").removeClass("copied")
    copyText.closest("*.contain-link").addClass("copied")
    copyText.select();
    document.execCommand("Copy");
  }
  
</script>

<style type="text/css" media="screen">
  .checkmark {display: none;}
  *.copied .checkmark {display: inline;}
</style>
<br />
<br />
<%= link_to 'Edit', edit_message_path(@message) , class: "button" %> 
<%= link_to 'Back', messages_path , class: "button" %>
